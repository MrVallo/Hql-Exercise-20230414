# Hql-Exercise-20230414
hql刷题
# 1.男性和女性的购物总金额统计

## 题目需求

从订单信息表（order_info）和用户信息表（user_info）中，分别统计每天男性和女性用户的订单总金额，如果当天男性或者女性没有购物，则统计结果为0。

## 期望结果如下：

| create_date <string> （日期） | total_amount_male <decimal(16,2)> （男性用户总金额） | total_amount_female <decimal(16,2)> （女性用户总金额） |
| :---------------------------: | :--------------------------------------------------: | :----------------------------------------------------: |
|          2020-10-08           |                       51950.00                       |                        24020.00                        |
|          2021-09-27           |                       29000.00                       |                          0.00                          |
|          2021-09-28           |                       70500.00                       |                          0.00                          |
|          2021-09-29           |                       43300.00                       |                          0.00                          |
|          2021-09-30           |                        860.00                        |                          0.00                          |
|          2021-10-01           |                         0.00                         |                       171680.00                        |
|          2021-10-02           |                         0.00                         |                        76150.00                        |
|          2021-10-03           |                       89880.00                       |                        5910.00                         |
|          2021-10-04           |                       9390.00                        |                       120100.00                        |
|          2021-10-05           |                      109760.00                       |                        69850.00                        |
|          2021-10-06           |                      101070.00                       |                        54300.00                        |
|          2021-10-07           |                       54700.00                       |                       129480.00                        |

## 需要用到的表：

**订单信息表：order_info**

| **order_id** (订单id) | **user_id** (用户id) | **create_date** (下单日期) | **total_amount** (订单金额) |
| --------------------- | -------------------- | -------------------------- | --------------------------- |
| 1                     | 101                  | 2021-09-30                 | 29000.00                    |
| 10                    | 103                  | 2020-10-02                 | 28000.00                    |

**用户信息表：user_info**

| user_id(用户id) | gender(性别) | birthday(生日) |
| --------------- | ------------ | -------------- |
| 101             | 男           | 1990-01-01     |
| 102             | 女           | 1991-02-01     |
| 103             | 女           | 1992-03-01     |
| 104             | 男           | 1993-04-01     |

## 思路

按照create_date分组，聚合求总金额

## 代码

```sql
SELECT
  create_date,
  sum(IF (gender = '男', total_amount, 0)) total_amount_male,
  sum(IF (gender = '女', total_amount, 0)) total_amount_female
FROM
  order_info t1
  JOIN user_info t2 ON t1.user_id = t2.user_id
GROUP BY
  create_date
```

